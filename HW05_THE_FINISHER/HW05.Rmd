---
title: "HW05_THE_FINISHER"
author: "Chad Fibke"
date: '2017-10-11'
output: github_document
---

# 1.Installation of data set and data analysis packages 

```{r}
library(gapminder)
library(tidyverse)
library(forcats)

```
Just some quick notes:

+ Comments about my code will be within code chunks:
```{r}
# Like this 
```
+ Comments about my workflow will be outside of the code chunks. 
+ I will be working with the gapminder dataset!

# 2.Factor management 
Let's take a look at gapminder to see what variables are concidered factors:
```{r}
str(gapminder)
```

Now we know gapminder's variable:

+ Country is a factor and  has 142 different levels.

```{r Country.levels, echo=TRUE}
levels(gapminder$country) %>% 
  head() %>% 
  knitr::kable(col.names = "Country Factors")# I'm only showing few levels to help our poor eyes
```

+ Continent is a factor and has 5 different levels. 
```{r Continent.levels, echo=TRUE}
levels(gapminder$continent) %>% 
  knitr::kable( col.names = "Continent Factors")

```

We now know what factors we are working with, so see what we have to drop! We want to drop Ocieania, but lets see what we are actually dropping:

```{r}
 EX.Ocieania <- gapminder %>% 
  filter(continent == "Oceania") 
 

EX.Ocieania$country %>%   
   fct_drop() %>% 
  levels() 

EX.Ocieania$continent %>%   
   fct_drop() %>% 
  nlevels() 
```
The above shows that when we drop the Ocieania Continent: 

+ One level will be dropped for continents.
+ Two levels  will be dropped for countries.

Now we know how many we are dropping lets go in the revese direction and drop them:
```{r}
Without.Ocieania <- gapminder %>% 
  filter(continent != "Oceania")

Droped.Ocieania <- Without.Ocieania %>%   
   droplevels()# droplevels was used because it can be applied to a dataset, whereas fct_drop  is applied to a vector. 

Droped.Ocieania$country %>%
  nlevels()# As seen above we have ofically droped the "Australia" and "New Zealand" levels, leaving us with 140 country levels.

Droped.Ocieania$continent %>%
  levels()# As seen above we have ofically droped the Ocieania level, leaving us with only 4 remaining continent levels.

```

We now have the Droped.Ocieania dataset with factors that are of intrest. 

Let use this dataset to reorder the country factor based on the higest population size for the Americas:
```{r population.growth.wrong, echo=TRUE}
POP.Growth <- Droped.Ocieania %>%
  filter(continent == "Americas") %>% 
  select(continent, country, year, pop) %>%
  group_by(country) %>%
  mutate(maxPop = max(pop))# this is just cleaning up some data to calclate the mam population size per continent
 POP.Growth %>%  
 ggplot(aes(x = country, y = maxPop))+
  geom_point()+
     theme(axis.text.x = element_text(angle = 90))

 
```

This graph makes our eyes work way to hard. Lets try reordering the factors based on population size!

```{r population.growth.right, echo=TRUE}
 POP.Growth %>%  
 ggplot(aes(x = fct_reorder(country, maxPop), y = maxPop))+
  geom_point()+
     theme(axis.text.x = element_text(angle = 90))+
  xlab("Countries")+
  ylab("Max Population Size")
```

